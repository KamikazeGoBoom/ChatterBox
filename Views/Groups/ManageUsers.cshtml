@model ChatterBox.Models.Group
@using Microsoft.AspNetCore.Identity
@using ChatterBox.Models
@inject UserManager<ApplicationUser> UserManager
@{
    ViewData["Title"] = $"Manage Users - {Model.Name}";
    var nonMembers = ViewBag.NonMembers as IEnumerable<ApplicationUser>;
}

<div class="container mt-4">
    <h2>Manage Users - @Model.Name</h2>
    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h4>Current Members</h4>
                </div>
                <div class="card-body">
                    <ul class="list-group">
                        @foreach (var member in Model.Members)
                        {
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                @member.User.UserName
                                <form asp-action="RemoveUserFromGroup" method="post" class="d-inline">
                                    <input type="hidden" name="groupId" value="@Model.GroupId" />
                                    <input type="hidden" name="userId" value="@member.UserId" />
                                    <button type="submit" class="btn btn-danger btn-sm">Remove</button>
                                </form>
                            </li>
                        }
                    </ul>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h4>Add New Members</h4>
                </div>
                <div class="card-body">
                    <ul class="list-group">
                        @foreach (var user in nonMembers)
                        {
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                @user.UserName
                                <form asp-action="AddUserToGroup" method="post" class="d-inline">
                                    <input type="hidden" name="groupId" value="@Model.GroupId" />
                                    <input type="hidden" name="userId" value="@user.Id" />
                                    <button type="submit" class="btn btn-success btn-sm">Add</button>
                                </form>
                            </li>
                        }
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="mt-4">
        <a asp-action="Details" asp-route-id="@Model.GroupId" class="btn btn-secondary">Back to Group</a>
    </div>
</div>